<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Hokkaido 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Noto Sans TC"', 'sans-serif'],
              display: ['"Zen Maru Gothic"', 'sans-serif'],
            },
            colors: {
              'hokkaido-blue': '#a0c4ff',
              'hokkaido-snow': '#f8f9fa',
              'hokkaido-accent': '#ff6b6b',
              'hokkaido-text': '#2d3436',
              'paper': '#fffdf5',
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #f0f2f5;
      /* Hide scrollbar for clean mobile look but allow scroll */
        -webkit-overflow-scrolling: touch;
      }
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0"
  }
}
</script>
</head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      // =========================================================================
      // ⚠️ 警告：遺失程式碼依賴項 (下一步錯誤點！)
      // App.js 引用了 5 個您尚未提供的本地檔案，它們的內容必須被貼在下方。
      // 程式碼執行時，如果 App.js 中有未定義的變數，將會出現 ReferenceError。
      // 1. './constants' (ITINERARY_DATA)
      // 2. './types' (DayPlan, ItineraryItem, Category)
      // 3. './components/WeatherWidget'
      // 4. './components/ExpenseTracker'
      // 5. './components/InfoView'
      // =========================================================================

      // --- 1. 依賴項和類型定義 (Placeholder) ---
      // 您必須將 constants.js, types.js 等檔案的內容放在這裡，或確保它們被全域定義。
      // 為了讓 App.js 程式碼編譯通過，我們必須在這裡宣告這些變數 (否則會 ReferenceError)。
      // 請注意：這些只是**空**的佔位符，如果您的應用程式需要它們的內容，您必須補齊！
      const ITINERARY_DATA = [];
      const Category = {Transport: 'Transport', Food: 'Food', Sightseeing: 'Sightseeing', Hotel: 'Hotel'};
      const DayPlan = {}; // 佔位
      const ItineraryItem = {}; // 佔位
      
      // 由於 WeatherWidget, ExpenseTracker, InfoView 未提供，我們使用空組件佔位。
      const WeatherWidget = (props) => <div>請放入 WeatherWidget.js 的內容。</div>;
      const ExpenseTracker = () => <div>請放入 ExpenseTracker.js 的內容。</div>;
      const InfoView = () => <div>請放入 InfoView.js 的內容。</div>;

      // 由於 App.js.txt 使用了 ES6 解構賦值，我們手動將其變更為全域變數引用 (由 importmap 提供)。
      const { useState, useEffect } = React;
      const { MapPin, Clock, Train, Utensils, Camera, Hotel, X, Navigation, Wallet, Info, Calendar, ChevronRight } = lucideReact;

      // --- 2. App.js 內容 (已移除 import/export) ---
      
      // [Source 14 - 34]: Utility Components
      const CategoryIcon = ({ category }) => { 
        switch (category) {
          [cite_start]case Category.Transport: return <Train size={18} className="text-blue-500" />; [cite: 14]
          [cite_start]case Category.Food: return <Utensils size={18} className="text-orange-500" />; [cite: 15]
          [cite_start]case Category.Sightseeing: return <Camera size={18} className="text-emerald-500" />; [cite: 15]
          [cite_start]case Category.Hotel: return <Hotel size={18} className="text-indigo-500" />; [cite: 16]
          [cite_start]default: return <Info size={18} className="text-gray-500" />; [cite: 16]
        }
      };
      
      const Tag = ({ text }) => { 
        [cite_start]const isMust = text.includes('必') || text.includes('No.1') || text.includes('限定'); [cite: 17, 18]
        [cite_start]const isBooked = text.includes('預約'); [cite: 18]
        
        let bgClass = "bg-stone-100 text-stone-600";
        [cite_start]if (isMust) bgClass = "bg-hokkaido-accent/10 text-hokkaido-accent border border-hokkaido-accent/20"; [cite: 18]
        [cite_start]if (isBooked) bgClass = "bg-indigo-50 text-indigo-600 border border-indigo-100"; [cite: 19]

        return (
          [cite_start]<span className={`text-[10px] px-2 py-0.5 rounded-full font-medium ${bgClass}`}> [cite: 19]
            [cite_start]{text} [cite: 19]
          </span>
        [cite_start]); [cite: 20]
      };
      
      const Modal = ({ item, onClose }) => { 
        [cite_start]if (!item) return null; [cite: 20]
        [cite_start]return ( [cite: 21]
          [cite_start]<div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-in fade-in duration-200"> [cite: 21]
            [cite_start]<div className="bg-white w-full max-w-md rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[85vh] animate-in slide-in-from-bottom duration-300"> [cite: 21]
              
              {/* Header Image or Solid Color */}
              [cite_start]<div className="h-32 bg-gradient-to-r from-hokkaido-blue to-indigo-100 relative shrink-0"> [cite: 21]
                [cite_start]{item.imageUrl && ( [cite: 21]
                  [cite_start]<img src={item.imageUrl} alt={item.title} className="w-full h-full object-cover opacity-80" /> [cite: 22]
                )}
                <button 
                  onClick={onClose} 
                  [cite_start]className="absolute top-4 right-4 bg-white/90 p-2 rounded-full shadow-sm hover:bg-white transition-colors" [cite: 22]
                >
                  [cite_start]<X size={20} className="text-stone-500" /> [cite: 22]
                </button>
              
                [cite_start]<div className="absolute bottom-4 left-6"> [cite: 23]
                  [cite_start]<span className="bg-white/90 px-3 py-1 rounded-full text-xs font-bold text-stone-700 shadow-sm flex items-center gap-1 w-fit"> [cite: 23]
                    [cite_start]<CategoryIcon category={item.category} /> [cite: 23]
                    [cite_start]{item.category} [cite: 23]
                  </span>
                </div>
              </div>

              {/* Content */}
              [cite_start]<div className="p-6 overflow-y-auto"> [cite: 24]
                [cite_start]<h2 className="text-2xl font-display font-bold text-stone-800 mb-1">{item.title}</h2> [cite: 24]
                [cite_start]{item.jpTitle && <h3 className="text-lg text-stone-400 font-display mb-4">{item.jpTitle}</h3>} [cite: 24]

                [cite_start]<div className="space-y-6"> [cite: 24]
                  {/* Quick Stats */}
                  [cite_start]<div className="grid grid-cols-2 gap-3 text-sm"> [cite: 24]
                    [cite_start]<div className="bg-stone-50 p-3 rounded-xl flex items-center gap-2"> [cite: 25]
                      [cite_start]<Clock size={16} className="text-stone-400" /> [cite: 25]
                      [cite_start]<span className="font-medium text-stone-700">{item.time}</span> [cite: 25]
                    </div>
                    [cite_start]{item.cost && ( [cite: 25]
                      [cite_start]<div className="bg-stone-50 p-3 rounded-xl flex items-center gap-2"> [cite: 26]
                        [cite_start]<span className="text-stone-400 font-bold">¥</span> [cite: 26]
                        [cite_start]<span className="font-medium text-stone-700">{item.cost.replace(/¥/g, '')}</span> [cite: 26]
                      </div>
                    [cite_start])} [cite: 26]
                  </div>

                  {/* Description */}
                  [cite_start]<div> [cite: 27]
                    [cite_start]<h4 className="text-xs font-bold text-stone-400 uppercase tracking-wider mb-2">簡介</h4> [cite: 27]
                    [cite_start]<p className="text-stone-600 leading-relaxed">{item.description}</p> [cite: 27]
                  </div>

                  {/* Details List */}
                  [cite_start]{item.details && item.details.length > 0 && ( [cite: 27]
                    [cite_start]<div> [cite: 28]
                      [cite_start]<h4 className="text-xs font-bold text-stone-400 uppercase tracking-wider mb-2">詳細資訊</h4> [cite: 28]
                      [cite_start]<ul className="space-y-3"> [cite: 28]
                        {item.details.map((detail, idx) => {
                           [cite_start]const isHighlight = detail.includes('必吃') || detail.includes('必買') || detail.includes('注意'); [cite: 28, 29]
                           return (
                              [cite_start]<li key={idx} className={`flex items-start gap-3 p-3 rounded-xl ${isHighlight ? 'bg-orange-50' : 'bg-stone-50'}`}> [cite: 29]
                                <div className={`mt-1.5 w-1.5 h-1.5 rounded-full shrink-0 ${isHighlight ? [cite_start]'bg-orange-400' : 'bg-stone-300'}`} /> [cite: 30]
                                <span className={`text-sm ${isHighlight ? [cite_start]'text-stone-800 font-medium' : 'text-stone-600'}`}>{detail}</span> [cite: 30]
                              </li>
                           [cite_start]); [cite: 31]
                        })}
                      </ul>
                    </div>
                  [cite_start])} [cite: 31]
                </div>
              </div>

              {/* Footer Actions */}
              [cite_start]<div className="p-4 border-t border-stone-100 bg-stone-50 shrink-0"> [cite: 31]
                <a 
                  [cite_start]href={`https://www.google.com/maps/search/?api=1&query=$${encodeURIComponent(item.location + ' Hokkaido')}`} [cite: 32]
                  target="_blank"
                  rel="noreferrer"
                  [cite_start]className="w-full py-3 bg-hokkaido-text text-white rounded-xl font-bold flex items-center justify-center gap-2 shadow-lg hover:bg-stone-700 active:scale-95 transition-all" [cite: 32]
                >
                  [cite_start]<Navigation size={18} /> [cite: 32]
                  [cite_start]導航前往 [cite: 33]
                </a>
              </div>
            </div>
          </div>
        [cite_start]); [cite: 34]
      };

      // [Source 34]: Main App Component Enum
      const Tab = { Itinerary: 'itinerary', Expenses: 'expenses', Info: 'info' };

      // [Source 34 - 68]: Main App Component
      const App = () => {
        [cite_start]const [activeTab, setActiveTab] = useState(Tab.Itinerary); [cite: 34]
        [cite_start]const [selectedDay, setSelectedDay] = useState(1); [cite: 35]
        [cite_start]const [selectedItem, setSelectedItem] = useState(null); [cite: 35]
        const currentDayPlan = ITINERARY_DATA.find(d => d.day === selectedDay) || [cite_start]ITINERARY_DATA[0]; [cite: 36]
        
        [cite_start]useEffect(() => { [cite: 37]
          // Scroll to top when day changes
          [cite_start]window.scrollTo(0,0); [cite: 37]
        [cite_start]}, [selectedDay, activeTab]); [cite: 37]
        
        [cite_start]return ( [cite: 38]
          [cite_start]<div className="min-h-screen font-sans text-hokkaido-text bg-[#f0f2f5] max-w-lg mx-auto shadow-2xl border-x border-white/50 relative"> [cite: 38]
            
            {/* Header Area */}
            [cite_start]<header className="sticky top-0 z-30 bg-white/95 backdrop-blur-md shadow-sm"> [cite: 38]
              [cite_start]<div className="flex justify-between items-center p-4"> [cite: 38]
                [cite_start]<h1 className="text-xl font-display font-bold text-stone-800"> [cite: 38]
                  [cite_start]{activeTab === Tab.Itinerary && "北海道之旅"} [cite: 38]
                  [cite_start]{activeTab === Tab.Expenses && "旅費記帳"} [cite: 39]
                  [cite_start]{activeTab === Tab.Info && "旅行資訊"} [cite: 39]
                </h1>
                [cite_start]<div className="text-xs font-bold text-stone-400 bg-stone-100 px-2 py-1 rounded-md">2025 Dec</div> [cite: 39]
              </div>

              {/* Day Selector (Only for Itinerary) */}
              [cite_start]{activeTab === Tab.Itinerary && ( [cite: 39]
                [cite_start]<div className="flex overflow-x-auto hide-scrollbar px-4 pb-3 gap-3 snap-x"> [cite: 40]
                  [cite_start]{ITINERARY_DATA.map((plan) => { [cite: 40]
                    [cite_start]const isActive = plan.day === selectedDay; [cite: 40]
                    [cite_start]return ( [cite: 40]
                      <button
                        key={plan.day}
                        [cite_start]onClick={() => setSelectedDay(plan.day)} [cite: 41]
                        [cite_start]className={`flex-shrink-0 flex flex-col items-center justify-center w-14 h-16 rounded-2xl transition-all duration-200 snap-center border ${ [cite: 41]
                          isActive 
                            ? [cite_start]'bg-hokkaido-text text-white shadow-md scale-105 border-transparent' [cite: 42]
                            [cite_start]: 'bg-white text-stone-400 border-stone-200 hover:bg-stone-50' [cite: 42]
                        }`}
                      >
                        [cite_start]<span className="text-[10px] font-bold opacity-80">Day {plan.day}</span> [cite: 42]
                        [cite_start]<span className="text-lg font-bold font-display">{plan.date.split('/')[1]}</span> [cite: 43]
                        [cite_start]<span className="text-[10px]">{plan.weekday}</span> [cite: 43]
                      </button>
                    [cite_start]); [cite: 43]
                  [cite_start]})} [cite: 44]
                </div>
              [cite_start])} [cite: 44]
            </header>

            {/* Main Content */}
            [cite_start]<main className="p-4 min-h-[80vh]"> [cite: 44]
              [cite_start]{activeTab === Tab.Itinerary && ( [cite: 44]
                [cite_start]<div className="animate-in fade-in slide-in-from-bottom-2 duration-300 pb-20"> [cite: 44]
                  {/* Daily Header */}
                  [cite_start]<div className="mb-6"> [cite: 45]
                    [cite_start]<h2 className="text-2xl font-display font-bold text-stone-800 leading-tight"> [cite: 45]
                      [cite_start]{currentDayPlan.title} [cite: 45]
                    </h2>
                    [cite_start]<div className="flex items-center gap-1 text-stone-500 text-sm mt-1"> [cite: 45]
                      [cite_start]<MapPin size={14} /> [cite: 45]
                      [cite_start]{currentDayPlan.city} [cite: 46]
                    </div>
                  </div>

                  {/* Weather Widget */}
                  [cite_start]<WeatherWidget lat={currentDayPlan.lat} lng={currentDayPlan.lng} city={currentDayPlan.city} /> [cite: 46]

                  {/* Timeline Items */}
                  [cite_start]<div className="space-y-4 relative pl-4 border-l-2 border-stone-200 ml-2"> [cite: 46]
                    [cite_start]{currentDayPlan.items.map((item, idx) => ( [cite: 47]
                      <div 
                        key={item.id} 
                        [cite_start]onClick={() => setSelectedItem(item)} [cite: 47]
                        [cite_start]className="relative group cursor-pointer" [cite: 47]
                      >
                        {/* Timeline Dot */}
                        <div className={`absolute -left-[25px] top-4 w-4 h-4 rounded-full border-2 border-white shadow-sm z-10 
                          ${item.category === Category.Transport ? [cite_start]'bg-blue-400' : [cite: 48, 49]
                            item.category === Category.Food ? [cite_start]'bg-orange-400' : [cite: 50]
                            item.category === Category.Sightseeing ? [cite_start]'bg-emerald-400' : 'bg-indigo-400'}`} [cite: 51]
                        />

                        {/* Card */}
                        [cite_start]<div className="bg-white rounded-2xl p-4 shadow-sm border border-stone-100 transition-all active:scale-[0.98] hover:shadow-md"> [cite: 51]
                          [cite_start]<div className="flex justify-between items-start mb-2"> [cite: 52]
                            [cite_start]<span className="text-xs font-bold text-stone-400 bg-stone-50 px-2 py-1 rounded-md"> [cite: 52]
                               [cite_start]{item.time} [cite: 52]
                             </span>
                             [cite_start]<div className="flex items-center gap-1 opacity-20 group-hover:opacity-100 transition-opacity"> [cite: 52]
                               [cite_start]<ChevronRight size={16} /> [cite: 53]
                             </div>
                          </div>
                          
                          [cite_start]<div className="flex items-start justify-between gap-4"> [cite: 54]
                            [cite_start]<div> [cite: 54]
                              [cite_start]<h3 className="font-bold text-stone-800 text-lg leading-snug mb-1">{item.title}</h3> [cite: 54]
                              [cite_start]<p className="text-stone-500 text-sm line-clamp-2 mb-3"> [cite: 55]
                                 [cite_start]{item.description} [cite: 55]
                              </p>
                            </div>
                            {/* Category Icon */}
                            [cite_start]<div className="bg-stone-50 p-2 rounded-xl shrink-0"> [cite: 56]
                               [cite_start]<CategoryIcon category={item.category} /> [cite: 56]
                            </div>
                          </div>

                          {/* Tags */}
                          [cite_start]{item.tags && item.tags.length > 0 && ( [cite: 57]
                            [cite_start]<div className="flex flex-wrap gap-2 mt-1"> [cite: 57]
                              [cite_start]{item.tags.map(tag => <Tag key={tag} text={tag} />)} [cite: 57]
                            [cite_start]</div> [cite: 58]
                          )}
                        </div>
                      </div>
                    [cite_start]))} [cite: 58]
                  </div>
                
                  {/* End of Day Marker */}
                  [cite_start]<div className="mt-8 text-center"> [cite: 59]
                    [cite_start]<span className="text-xs text-stone-300 font-display tracking-widest uppercase">End of Day {selectedDay}</span> [cite: 59]
                  </div>
                </div>
              [cite_start])} [cite: 59]

              [cite_start]{activeTab === Tab.Expenses && ( [cite: 60]
                [cite_start]<div className="animate-in fade-in duration-300"> [cite: 60]
                  [cite_start]<ExpenseTracker /> [cite: 60]
                </div>
              [cite_start])} [cite: 60]

              [cite_start]{activeTab === Tab.Info && ( [cite: 60]
                [cite_start]<div className="animate-in fade-in duration-300"> [cite: 60]
                  [cite_start]<InfoView /> [cite: 61]
                </div>
              [cite_start])} [cite: 61]
            </main>

            {/* Bottom Navigation */}
            [cite_start]<nav className="fixed bottom-0 left-0 right-0 max-w-lg mx-auto bg-white border-t border-stone-100 pb-safe pt-2 px-6 shadow-[0_-5px_20px_rgba(0,0,0,0.03)] z-40"> [cite: 61]
              [cite_start]<div className="flex justify-between items-center h-16"> [cite: 61]
                <button 
                  onClick={() => setActiveTab(Tab.Itinerary)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Itinerary ? [cite_start]'text-stone-800' : 'text-stone-400'}`} [cite: 62]
                >
                  <Calendar size={24} strokeWidth={activeTab === Tab.Itinerary ? [cite_start]2.5 : 2} /> [cite: 63]
                  [cite_start]<span className="text-[10px] font-bold">行程</span> [cite: 63]
                </button>
                
                <button 
                  onClick={() => setActiveTab(Tab.Expenses)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Expenses ? [cite_start]'text-stone-800' : 'text-stone-400'}`} [cite: 64]
                >
                  <Wallet size={24} strokeWidth={activeTab === Tab.Expenses ? [cite_start]2.5 : 2} /> [cite: 65]
                  [cite_start]<span className="text-[10px] font-bold">記帳</span> [cite: 65]
                </button>

                <button 
                  onClick={() => setActiveTab(Tab.Info)}
                  className={`flex flex-col items-center gap-1 transition-colors ${activeTab === Tab.Info ? [cite_start]'text-stone-800' : 'text-stone-400'}`} [cite: 66]
                >
                  <Info size={24} strokeWidth={activeTab === Tab.Info ? [cite_start]2.5 : 2} /> [cite: 67]
                  [cite_start]<span className="text-[10px] font-bold">資訊</span> [cite: 67]
                </button>
              </div>
            </nav>

            {/* Item Detail Modal */}
            [cite_start]{selectedItem && ( [cite: 67]
              [cite_start]<Modal item={selectedItem} onClose={() => setSelectedItem(null)} /> [cite: 67]
            )}

          </div>
        [cite_start]); [cite: 68]
      };
      // (App.js 內容結束)

      // --- 3. index.js 渲染邏輯 (已移除 import) ---
      [cite_start]const rootElement = document.getElementById('root'); [cite: 1]
      
      [cite_start]if (!rootElement) { [cite: 2]
        [cite_start]throw new Error("Could not find root element to mount to"); [cite: 2]
      }

      [cite_start]const root = ReactDOM.createRoot(rootElement); [cite: 2]
      
      [cite_start]root.render( [cite: 3]
        [cite_start]<React.StrictMode> [cite: 3]
          [cite_start]<App /> [cite: 3]
        [cite_start]</React.StrictMode> [cite: 3]
      );
    </script> 
  </body>
</html>
